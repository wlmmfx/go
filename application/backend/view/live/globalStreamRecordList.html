<style type="text/css">

    .table th, .table td {
        vertical-align: middle !important;
    }
    .wrapper {
        margin-left: -20px;
        margin-right: -19px;
        margin-bottom: -24px;
        margin-top: -17px;
    }
</style>
<div class="row">
    <div class="alert alert-info no-margin">
        <button type="button" class="close" data-dismiss="alert">
            <i class="icon-remove"></i>
        </button>

        <i class="icon-umbrella bigger-120 blue"></i>
        推流地址：rtmp://video-center.alivecdn.com/{live}/{流名称}?vhost={推流域名}<br/>
        <i class="icon-facetime-video bigger-120 blue"></i>
        eg：rtmp://stream.tinywan.com/<strong>live123</strong>/<strong>8001513259043</strong>?vhost= <strong>lives.tinywan.com</strong>

    </div>
    <div class="hr dotted"></div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>推流地址</th>
            <th>推流域名</th>
            <th>流名称</th>
            <th>推流时间</th>
            <th>推流地域</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        {volist name='lists' id='vo'}
        <tr class="gradeX">
            <td>rtmp://stream.tinywan.com/{$vo['app_name']}</td>
            <td>{$vo['domain_name']}</td>
            <td>{$vo['stream_name']}</td>

            <td>
                起:&nbsp;&nbsp;{$vo['start_time']|date="Y-m-d H:i:s",###}<br/>
                止:&nbsp;{empty name="$vo['stop_time']"}
                <i class="icon-spinner icon-spin green"></i> <span class="smaller lighter green">正在推流</span>
                {else /}
                {$vo['stop_time']|date="Y-m-d H:i:s",###}
                {/empty}
            </td>
            <td>{$vo['client_ip']|ip_format}</td>
            <td>
                <a href="{:url('backend/category/subpage',['id'=>$vo['id']])}">
                    <button class="btn btn-primary btn-xs">
                        <i class="icon-folder-open"></i>详情
                    </button>
                </a>
                <a href="javascript:playModal('{$vo.domain_name}','{$vo.app_name}','{$vo.stream_name}');">
                    <button class="btn btn-warning btn-xs">
                        <i class="icon-play-circle"></i>预览
                    </button>
                </a>
            </td>
        </tr>
        {/volist}
        </tbody>
    </table>
    <div>{$lists->render()}</div>
</div>

<!-- 模态框（Modal） -->
<div class="modal fade" id="playModal" tabindex="-1" role="dialog" aria-labelledby="playModal" aria-hidden="true">
    <div class="modal-dialog ">
        <div class="modal-content ">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h5 class="modal-title"><i class="icon-play-circle"></i> 预览播放</h5>
            </div>
            <div class="modal-body">
                <div class="wrapper">
                    <video id="live-stream" class="video-js vjs-default-skin" controls autoplay>
                        <source src="" type="application/x-mpegURL">
                    </video>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function playModal(domainName, appName, streamName) {
        $("#playModal").modal("show");
        var options = {
            width: 578,
            height: 320
        };
        $("#live-stream").html('<source src="https://' + domainName + '/' + appName + '/' + streamName + '.m3u8" type="application/x-mpegURL">');
        videojs("live-stream", options).ready(function () {
            var myPlayer = this;
            myPlayer.play();
        });
        console.log("https://" + domainName + '/' + appName + '/' + streamName + '.m3u8');
    }

</script>